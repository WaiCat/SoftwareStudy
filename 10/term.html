<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>DOM</title>
    <style>
      fieldset {
        display: none;
      }
    </style>
  </head>
  <script src="https://code.jquery.com/jquery-3.6.4.js"></script>
  <script src="https://code.jquery.com/jquery-migrate-3.4.1.js"></script>
  <script>
    var users = [];
    var lecs = ["수학", "과학", "영어"];

    function back() {
      document.getElementById("sib").style.display = "block";
      document.getElementById("sub").style.display = "block";
      document.getElementById("signin").style.display = "none";
      document.getElementById("signup").style.display = "none";
    }

    function signup() {
      document.getElementById("sib").style.display = "none";
      document.getElementById("sub").style.display = "none";
      document.getElementById("signin").style.display = "block";

      return false;
    }
    function signupfuntion() {
      var username = document.getElementById("username1").value;
      var password = document.getElementById("password1").value;
      for (var i = 0; i < users.length; i++) {
        if (username == users[i].username) {
          document.getElementById("username1").value = "";
          document.getElementById("password1").value = "";
          alert("이미 있는 아이디 입니다. 다시 입력하세요");
          return false;
        }
      }
      let user = { username: username, password: password };
      alert("회원가입이 완료되었습니다");
      users.push(user);
      back();
      document.getElementById("username1").value = "";
      document.getElementById("password1").value = "";

      return false;
    }

    function signin() {
      document.getElementById("sib").style.display = "none";
      document.getElementById("sub").style.display = "none";
      document.getElementById("signup").style.display = "block";

      return false;
    }
    function signinfuntion() {
      var username = document.getElementById("username").value;
      var password = document.getElementById("password").value;

      if (username == "admin" && password == "a") {
        alert("Admin 계정 로그인");
        document.querySelector("#user").style.display = "block";
        document.querySelector("#adminset").style.display = "block";
        document.getElementById("display-username").textContent = username;
        document.getElementById("display-password").textContent = password;
      } else {
        for (var i = 0; i < users.length; i++) {
          if (username == users[i].username && password == users[i].password) {
            document.querySelector("#user").style.display = "block";
            document.querySelector("#userset").style.display = "block";
            document.getElementById("display-username").textContent = username;
            document.getElementById("display-password").textContent = password;
            alert("로그인 완료");
            // document.getElementById("username").value = "";
            // document.getElementById("password").value = "";
            return false;
          }
        }
        alert("로그인 실패");
        back();
        document.getElementById("username").value = "";
        document.getElementById("password").value = "";
      }
      return false; // 폼 제출 방지
    }
    function loginout() {}
    function showusers() {
      $("#usermanage").css("display", "block");
      $("#lecmanage").css("display", "none");
      var userList = $("#userlist");
      userList.empty(); // 기존 내용 초기화

      for (var i = 0; i < users.length; i++) {
        var user = users[i];
        var listItem = $("<p></p>").text(
          "username: " + user.username + " password: " + user.password
        );

        var button1 = $("<button></button>").text("수강목록");

        var button2 = $("<button></button>")
          .text("회원삭제")
          .click(function () {
            var index = $(this).data("index");
            users.splice(index, 1); // 배열에서 사용자 삭제
            showusers(); // 변경된 목록 다시 표시
          });

        userList.append(listItem, button1, button2);
      }
    }
    function showlec() {
      $("#lecmanage").css("display", "block");
      $("#usermanage").css("display", "none");
      var leclist = $("#leclist");
      leclist.empty();
      for (var i = 0; i < lecs.length; i++) {
        var lec = lecs[i];
        var listItem = $("<p></p>").text("lecture: " + lec);
        var button = $("<button></button>")
          .text("강의 삭제")
          .click(function () {
            var index = $(this).data("index");
            lecs.splice(index, 1); // 배열에서 사용자 삭제
            showlec(); // 변경된 목록 다시 표시
          });
        leclist.append(listItem, button);
      }
    }

    function addlec() {
      var lec = document.getElementById("lec").value;
      for (var i = 0; i < lecs.length; i++) {
        var lecname = lecs[i];
        if (lec == lecname) {
          alert("이미 있는 강의입니다.");
          return false;
        }
      }
      lecs.push(lec);
      alert("강의가 추가되었습니다.");
      document.getElementById("lec").value = "";
      showlec();
      return false;
    }
    function myif() {
      var username = document.getElementById("username").value;
      var index = users.findIndex((i) => i.username == username);
    }
  </script>

  <body>
    <button id="sib" onclick="signup()">회원가입</button>

    <button id="sub" onclick="signin()">로그인</button>

    <fieldset id="signin">
      <legend>회원가입</legend>
      <p>
        <label for="username1">사용자 이름:</label>
        <input type="text" id="username1" name="username1" required />
      </p>
      <p>
        <label for="password1">비밀번호:</label>
        <input type="password" id="password1" name="password1" required />
      </p>
      <p>
        <input
          type="submit"
          style="margin-right: 20px"
          value="회원가입"
          onclick="signupfuntion()"
        />
        <input type="reset" value="뒤로가기" onclick="back()" />
      </p>
    </fieldset>

    <fieldset id="signup">
      <legend>로그인</legend>
      <p>
        <label for="username">사용자 이름:</label>
        <input type="text" id="username" name="username" required />
      </p>
      <p>
        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password" required />
      </p>
      <p>
        <input type="submit" value="로그인" onclick="signinfuntion()" />
        <input type="reset" value="뒤로가기" onclick="back()" />
      </p>
    </fieldset>

    <fieldset id="user">
      <h3>입력된 정보:</h3>
      <p>아이디: <span id="display-username"></span></p>
      <p>비밀번호: <span id="display-password"></span></p>
      <button onclick="loginout()">로그아웃</button>
    </fieldset>

    <div id="adminset" style="display: none">
      <fieldset style="display: block">
        <button id="userm" onclick="showusers()">유저 관리</button>
        <button id="lecm" onclick="showlec()">강의 관리</button>
      </fieldset>
      <fieldset id="usermanage">
        <legend>유저 관리</legend>
        <div id="userlist"></div>
      </fieldset>
      <fieldset id="lecmanage">
        <legend>강의 관리</legend>
        <div id="leclist"></div>
        <input type="text" id="lec" />
        <input type="submit" value="강의 추가" onclick="addlec()" />
      </fieldset>
    </div>
    <div id="userset" style="display: none">
      <fieldset style="display: block">
        <button id="userif" onclick="myif()">개인 정보 변경</button>
        <button id="userlec" onclick="mylec()">내 강의</button>
      </fieldset>
      <fieldset id="myif">
        <label for="newid">새로운 아이디:</label>
        <input type="text" id="newid" required />
        <label for="newpw">새로운 비밀번호:</label>
        <input type="text" id="newpw" required />
        <button onclick="newif()">정보 변경하기</button>
      </fieldset>
    </div>
  </body>
</html>
